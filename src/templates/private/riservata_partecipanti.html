{% extends "base.html" %} {% block content %}
<div
  id="flash-notifications"
  class="position-fixed top-0 start-50 translate-middle-x mt-3"
  style="z-index: 1050; max-width: 400px"
>
  {% with messages = get_flashed_messages(with_categories=false) %} {% if
  messages %} {% for message in messages %}
  <div
    class="alert alert-success alert-dismissible fade show shadow"
    role="alert"
  >
    {{ message }}
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="alert"
      aria-label="Close"
    ></button>
  </div>
  {% endfor %} {% endif %} {% endwith %}
</div>
<div class="container mt-5">
  <h2>Area Riservata Partecipanti</h2>

  {% if biglietto %}
  <h3>Dettagli Biglietto</h3>
  <ul>
    <li><strong>Tipo:</strong> {{ biglietto.tipo }}</li>
    <li><strong>Data Acquisto:</strong> {{ biglietto.data_acquisto }}</li>
    <li>
      <strong>Giorni Validità:</strong>
      <ul>
        {% for giorno in biglietto.giorni %}
        <li>{{ giorno }}</li>
        {% endfor %}
      </ul>
    </li>
  </ul>
  {% else %}
  <h3>Acquista un Biglietto</h3>
  <form method="POST" action="{{ url_for('private.compra_biglietto') }}">
    <div class="mb-3">
      <label for="tipo" class="form-label">Tipo di Biglietto</label>
      <select class="form-select" id="tipo" name="tipo" required>
        <option value="" selected disabled>Seleziona un tipo</option>
        <option value="Biglietto Giornaliero">Biglietto Giornaliero</option>
        <option value="Pass 2 Giorni">Pass 2 Giorni</option>
        <option value="Full Pass">Full Pass</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Seleziona i Giorni</label>
      <div class="form-check">
        <input
          class="form-check-input"
          type="checkbox"
          name="giorni"
          value="Venerdi"
          id="venerdi"
        />
        <label class="form-check-label" for="venerdi">Venerdì</label>
      </div>
      <div class="form-check">
        <input
          class="form-check-input"
          type="checkbox"
          name="giorni"
          value="Sabato"
          id="sabato"
        />
        <label class="form-check-label" for="sabato">Sabato</label>
      </div>
      <div class="form-check">
        <input
          class="form-check-input"
          type="checkbox"
          name="giorni"
          value="Domenica"
          id="domenica"
        />
        <label class="form-check-label" for="domenica">Domenica</label>
      </div>
    </div>

    <button type="submit" class="btn btn-primary">Acquista</button>
  </form>

  <script>
    const tipoSelect = document.getElementById("tipo");
    const giorniCheckboxes = document.querySelectorAll('input[name="giorni"]');

    tipoSelect.addEventListener("change", () => {
      const tipo = tipoSelect.value;

      giorniCheckboxes.forEach((cb) => {
        cb.checked = false;
        cb.disabled = false;
      });

      if (tipo === "Full Pass") {
        giorniCheckboxes.forEach((cb) => {
          cb.checked = true;
          cb.disabled = true;
        });
      }
    });
  </script>
  {% endif %}
</div>
{% endblock %}
